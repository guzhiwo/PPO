**Дата:** 6 ноября 2023 г.

**Статус:** Принято

**Контекст:**

В сервисе такси заказы поступают в режиме реального времени, и асинхронная обработка через брокера сообщений может
улучшить производительность и отзывчивость системы. Заказы и их обработка являются лишь одним из примеров применения
очередей в сервисе такси.

**Рассмотренные варианты:**

Облачные решения

1. **AmazonSQS (Simple Queue Protocol)**
2. **Mail.ru Cloud Queues**
3. **Yandex Message Cloud**
4. **CloudAMQP**

Специализированные брокеры

1. **RabbitMQ:** Традиционный брокер с протоколом AMQP
2. **Kafka:** Конкурирует с Rabbit'ом, распределенный лог сообщений для стриминга
3. **ActiveMQ:**
4. **Tarantool Queue:**
5. **NATS:** Рассчитан на масштабирование, довольно молодой проект, хороший инструмент для соединения микросервисов.
6. **NSQ:**

Реализация очереди с помощью СУБД:

1. **PgQueue**
2. **Tarantool:** Дает возможность создавать многие продукты поверх данных, можно получить ровно ту очередь, которая
   нужна нам.
3. **Redis**

"Сокеты на стероидах"

Изначально ничего не хранят, они лишь дают некоторый интерфейс взаимодействия: с точки зрения одного узла этот брокер
может паблишить сообщение, с точки зрения другого узла - он может сабскрайбиться на сообщения. Получается как небольшая
надстройка над сокетами.

1. **NATS**
2. **ZeroMQ**

**Решение:**

Выбран RabbitMQ.

**Обоснование:**

- **Поддержка протоколов:** AMQP, MQTT, STOMP, в основном будет использоваться AMQP.
- **Гибкая работа:** Есть приоритеты, можно создавать отложенные сообщения и фоновые задачи, которые можно отложить и
  выполнить позднее, чего нельзя сделать, например, в Kafka'е.
- **Масштабируемость:** Нет ограничения на количество потребителей. Можно подключить любое количество потребителей и они
  будут быстрее разгребать сообщения.
- **Хранение данных:** Доступны варианты хранения данных в памяти, на диске, можно реплицировать данные.
- **Простой в освоении:** Легко начать его использовать в своем проекте.

**Минусы:**

- **Отказоустойчивость:** Сложный в настройке отказоустойчивых сценариев.

**Последствия:**

- Используем как традиционный pub/sub брокер
- Слой соединения микросервисов. Шина сообщений.

**Присутствовавшие люди:**

- Павел Ермаков
- Ярослав Кузьмин
- Даниил Пырков
